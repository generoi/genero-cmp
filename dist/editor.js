(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(e){var n=function(e,n){if("object"!=t(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,n||"default");if("object"!=t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==t(n)?n:n+""}function n(t,n,r){return(n=e(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}const r=window.wp.hooks,o=window.wp.i18n,s=window.wp.blocks,i=window.wp.compose,c=window.wp.blockEditor,l=window.wp.components,u=window.ReactJSXRuntime;function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?p(Object(r),!0).forEach((function(e){n(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function d(t){return(0,s.hasBlockSupport)(t,"customClassName",!0)}const b=(0,i.createHigherOrderComponent)((t=>e=>{const{name:n,attributes:r}=e;if(d(n)&&r.consents?.length){const n=r?.consentOptin?"optin":"optout";let o=e.wrapperProps;return o=a(a({},o),{},{[`data-gds-cmp-consent-${n}`]:r.consents.join(" ")}),(0,u.jsx)(t,a(a({},e),{},{wrapperProps:o}))}return(0,u.jsx)(t,a({},e))})),m=(0,i.createHigherOrderComponent)((t=>e=>{if(d(e.name)&&e.isSelected){const n=window.gdsCmp.consents;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(t,a({},e)),(0,u.jsx)(c.InspectorAdvancedControls,{children:(0,u.jsxs)(l.BaseControl,{id:"consent-settings",label:(0,o.__)("Consent settings"),children:[(0,u.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,u.jsxs)(l.ButtonGroup,{children:[(0,u.jsx)(l.Button,{isSmall:!0,isPressed:e.attributes?.consentOptin,onClick:()=>e.setAttributes({consentOptin:!0}),children:(0,o.__)("Visible")}),(0,u.jsx)(l.Button,{isSmall:!0,isPressed:!e.attributes?.consentOptin,onClick:()=>e.setAttributes({consentOptin:!1}),children:(0,o.__)("Hidden")})]}),(0,u.jsx)("p",{children:"when user has given all consents below"})]}),(0,u.jsx)("div",{children:(0,u.jsx)(l.ButtonGroup,{children:n.map((({id:t,label:n})=>(0,u.jsx)(l.Button,{isSmall:!0,isPressed:e.attributes.consents?.includes?.(t),onClick:()=>{const n=e.attributes.consents||[];e.setAttributes({consents:n.includes(t)?n.filter((e=>e!==t)):n.concat([t])})},children:n})))})})]})})]})}return(0,u.jsx)(t,a({},e))}),"withInspectorControl");(0,r.addFilter)("blocks.registerBlockType","genero-cmp-consent/attribute",(function(t){return d(t.name)&&(t.attributes=a(a({},t.attributes),{},{consentOptin:{type:"bool",default:!1},consents:{type:"array",items:{type:"string"},default:[]}})),t})),(0,r.addFilter)("editor.BlockListBlock","genero-cmp-consent/with-data-attributes",b),(0,r.addFilter)("editor.BlockEdit","genero-cmp-consent/with-inspector-control",m),(0,r.addFilter)("blocks.getSaveContent.extraProps","genero-cmp-consent/save-props",(function(t,e,n){if(d(e)&&n.consents.length){t[`data-gds-cmp-consent-${n?.consentOptin?"optin":"optout"}`]=n.consents.join(" ")}return t}))})();